<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Deploying SiteWhere on Docker Swarm | SiteWhere</title>
    <meta name="description" content="SiteWhere CE 2.1.1 Documentation">
    <link rel="icon" href="/docs/2.1.1/images/favicon.png">
    
    <link rel="preload" href="/docs/2.1.1/assets/css/0.styles.8f4696ac.css" as="style"><link rel="preload" href="/docs/2.1.1/assets/js/app.5ea96ced.js" as="script"><link rel="preload" href="/docs/2.1.1/assets/js/7.af7f9977.js" as="script"><link rel="prefetch" href="/docs/2.1.1/assets/js/10.de60f8ea.js"><link rel="prefetch" href="/docs/2.1.1/assets/js/11.61b7b233.js"><link rel="prefetch" href="/docs/2.1.1/assets/js/12.8ef97410.js"><link rel="prefetch" href="/docs/2.1.1/assets/js/13.b9bce44f.js"><link rel="prefetch" href="/docs/2.1.1/assets/js/14.c70b456e.js"><link rel="prefetch" href="/docs/2.1.1/assets/js/15.22c6d647.js"><link rel="prefetch" href="/docs/2.1.1/assets/js/16.d168594a.js"><link rel="prefetch" href="/docs/2.1.1/assets/js/17.6507072d.js"><link rel="prefetch" href="/docs/2.1.1/assets/js/18.c58d4110.js"><link rel="prefetch" href="/docs/2.1.1/assets/js/19.ce2a1670.js"><link rel="prefetch" href="/docs/2.1.1/assets/js/2.4ed7eea7.js"><link rel="prefetch" href="/docs/2.1.1/assets/js/20.65b7d1f6.js"><link rel="prefetch" href="/docs/2.1.1/assets/js/21.771cdecc.js"><link rel="prefetch" href="/docs/2.1.1/assets/js/22.08b50ca2.js"><link rel="prefetch" href="/docs/2.1.1/assets/js/23.73eb483e.js"><link rel="prefetch" href="/docs/2.1.1/assets/js/24.77a22a99.js"><link rel="prefetch" href="/docs/2.1.1/assets/js/25.29fdd8c9.js"><link rel="prefetch" href="/docs/2.1.1/assets/js/26.7bf7ec45.js"><link rel="prefetch" href="/docs/2.1.1/assets/js/27.c9d12e7e.js"><link rel="prefetch" href="/docs/2.1.1/assets/js/28.ca74e435.js"><link rel="prefetch" href="/docs/2.1.1/assets/js/29.43f8a53b.js"><link rel="prefetch" href="/docs/2.1.1/assets/js/3.b8acad57.js"><link rel="prefetch" href="/docs/2.1.1/assets/js/30.6d7a8661.js"><link rel="prefetch" href="/docs/2.1.1/assets/js/31.7799366e.js"><link rel="prefetch" href="/docs/2.1.1/assets/js/32.7d8631c5.js"><link rel="prefetch" href="/docs/2.1.1/assets/js/33.660f9109.js"><link rel="prefetch" href="/docs/2.1.1/assets/js/34.32f2f621.js"><link rel="prefetch" href="/docs/2.1.1/assets/js/35.acb532db.js"><link rel="prefetch" href="/docs/2.1.1/assets/js/36.2784bf3b.js"><link rel="prefetch" href="/docs/2.1.1/assets/js/4.771e66cd.js"><link rel="prefetch" href="/docs/2.1.1/assets/js/5.a17990ba.js"><link rel="prefetch" href="/docs/2.1.1/assets/js/6.0436d3c9.js"><link rel="prefetch" href="/docs/2.1.1/assets/js/8.9354698e.js"><link rel="prefetch" href="/docs/2.1.1/assets/js/9.054083e8.js">
    <link rel="stylesheet" href="/docs/2.1.1/assets/css/0.styles.8f4696ac.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/docs/2.1.1/" class="home-link router-link-active"><img src="/docs/2.1.1/images/logo.svg" alt="SiteWhere" class="logo"></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/docs/2.1.1/platform/" class="nav-link">Platform</a></div><div class="nav-item"><a href="/docs/2.1.1/guide/" class="nav-link">User Guide</a></div><div class="nav-item"><a href="/docs/2.1.1/deployment/" class="nav-link router-link-active">Deployment</a></div><div class="nav-item"><a href="/docs/2.1.1/development/" class="nav-link">Development</a></div><div class="nav-item"><a href="https://github.com/sitewhere/sitewhere" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Languages</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs/2.1.1/deployment/docker.html" class="nav-link router-link-exact-active router-link-active">English</a></li><li class="dropdown-item"><!----> <a href="/docs/2.1.1/es/deployment/docker.html" class="nav-link">Español</a></li></ul></div></div> <a href="https://github.com/sitewhere/sitewhere-documentation" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/docs/2.1.1/platform/" class="nav-link">Platform</a></div><div class="nav-item"><a href="/docs/2.1.1/guide/" class="nav-link">User Guide</a></div><div class="nav-item"><a href="/docs/2.1.1/deployment/" class="nav-link router-link-active">Deployment</a></div><div class="nav-item"><a href="/docs/2.1.1/development/" class="nav-link">Development</a></div><div class="nav-item"><a href="https://github.com/sitewhere/sitewhere" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Languages</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs/2.1.1/deployment/docker.html" class="nav-link router-link-exact-active router-link-active">English</a></li><li class="dropdown-item"><!----> <a href="/docs/2.1.1/es/deployment/docker.html" class="nav-link">Español</a></li></ul></div></div> <a href="https://github.com/sitewhere/sitewhere-documentation" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><a href="/docs/2.1.1/deployment/" class="sidebar-link">SiteWhere Deployment Guide</a></li></ul> </div> <div class="page"> <div class="content"><h1 id="deploying-sitewhere-on-docker-swarm"><a href="#deploying-sitewhere-on-docker-swarm" aria-hidden="true" class="header-anchor">#</a> Deploying SiteWhere on Docker Swarm</h1> <h2 id="system-requirements"><a href="#system-requirements" aria-hidden="true" class="header-anchor">#</a> System Requirements</h2> <p>Because SiteWhere 2.0 uses a microservices architecture, the number of
processes running concurrently has increased, which in turn requires
more memory and processing power. The minimum hardware specifications
for a single machine running a SiteWhere instance is:</p> <table><thead><tr><th>Resource</th> <th>Min Value</th></tr></thead> <tbody><tr><td>Memory</td> <td>16GB RAM</td></tr> <tr><td>CPU</td> <td>2 CPUs</td></tr> <tr><td>Hard Disk/SSD</td> <td>80GB</td></tr></tbody></table> <p>When distributing microservices across multiple machines using
<a href="https://github.com/docker/swarm" target="_blank" rel="noopener noreferrer">Docker Swarm<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> or other orchestration
technologies, the per-machine requirements can be lower since the load
is distributed.</p> <p>Another consideration in deploying SiteWhere is whether the
<a href="https://kafka.apache.org/" target="_blank" rel="noopener noreferrer">Apache Kafka<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> and
<a href="https://zookeeper.apache.org/" target="_blank" rel="noopener noreferrer">Apache ZooKeeper<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> instances are running
in Docker or managed separately. In production environments, Kafka and
ZooKeeper clusters should be managed externally from the SiteWhere instance
using best practices defined by the individual technologies. The SiteWhere
team will release more information on preferred topologies as the 2.0
architecture nears general availability.</p> <h2 id="installing-docker-and-docker-compose"><a href="#installing-docker-and-docker-compose" aria-hidden="true" class="header-anchor">#</a> Installing Docker and Docker Compose</h2> <p>SiteWhere 2.0 uses Docker as the core deployment model since the technology
is supported in all major cloud environments in addition to being easy to
use for on-premise installations. For single-machine installations, Docker
Engine can be installed based on the process detailed in the link below:</p> <p><a href="https://docs.docker.com/engine/installation/" target="_blank" rel="noopener noreferrer">Install Docker Engine<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h3 id="install-docker-compose"><a href="#install-docker-compose" aria-hidden="true" class="header-anchor">#</a> Install Docker Compose</h3> <p>In Addition to Docker Engine, some form of orchestration engine should be installed
to allow for many Docker services to be deployed at once rather than manually
deploying them individually. In production deployments, SiteWhere 2.0 will leverage
the new <a href="https://docs.docker.com/engine/reference/commandline/stack_deploy/" target="_blank" rel="noopener noreferrer">stack<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>
support in Docker Swarm to launch the system. For a local installation, it is often easier to use
<a href="https://docs.docker.com/compose/install/" target="_blank" rel="noopener noreferrer">Docker Compose<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> which provides a simple
methodology for deploying many services at once while aggregating logs to the console
for easier debugging. Start by downloading and installing Docker Compose as detailed below:</p> <p><a href="https://docs.docker.com/compose/install/" target="_blank" rel="noopener noreferrer">Install Docker Compose<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h3 id="enable-swarm-mode"><a href="#enable-swarm-mode" aria-hidden="true" class="header-anchor">#</a> Enable Swarm Mode</h3> <p>Some aspects of the deployment process require features such as overlay networks that are
only available in Docker Swarm. Since Swarm is included in the Docker Engine, it can
be enabled and used in single-machine local deployments without the need for building
more complex topologies. Enable Swarm mode using the following command:</p> <div class="language-sh extra-class"><pre class="language-text"><code>docker swarm init
</code></pre></div><h2 id="using-sitewhere-recipes-to-build-an-instance"><a href="#using-sitewhere-recipes-to-build-an-instance" aria-hidden="true" class="header-anchor">#</a> Using SiteWhere Recipes to Build an Instance</h2> <p>Since the architecture and system configuration for SiteWhere allow for many
different combinations of components for developing custom systems, the
SiteWhere team provides a list of <em>recipes</em> for common system configurations
that act as a starting point for building instances. The repository for
SiteWhere 2.0 recipes can be accessed via the link below:</p> <p><a href="https://github.com/sitewhere/sitewhere-recipes" target="_blank" rel="noopener noreferrer">SiteWhere Recipes Repository<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h3 id="clone-the-recipes-repository"><a href="#clone-the-recipes-repository" aria-hidden="true" class="header-anchor">#</a> Clone the Recipes Repository</h3> <p>Open a terminal and start by cloning the recipes repository to the machine
where you have the Docker environment configured. The repository can be cloned
with the following command:</p> <div class="language-sh extra-class"><pre class="language-text"><code>git clone https://github.com/sitewhere/sitewhere-recipes.git
</code></pre></div><p>Once the repository has been cloned, navigate into the <strong>sitewhere-recipes/docker-compose</strong>
subdirectory. This directory contains sample configurations for many common SiteWhere
deployment scenarios.</p> <h3 id="start-infrastructure-services"><a href="#start-infrastructure-services" aria-hidden="true" class="header-anchor">#</a> Start Infrastructure Services</h3> <p>To better emulate a production environment, separate recipes are provided for
infrastructure services such as Apache ZooKeeper, Kafka, MQTT brokers, databases, and
other non-SiteWhere components. To start the infrastructure containers, navigate to the
<strong>sitewhere-recipes/docker-compose/infrastructure_default</strong> subdirectory (or one of the other
recipes depending on which components should be loaded). Execute the following command which
will start the infrastructure based on the configuration outlined in the
<strong>docker-compose.yml</strong> file.</p> <div class="language-sh extra-class"><pre class="language-text"><code>docker-compose up
</code></pre></div><h3 id="start-sitewhere-microservices"><a href="#start-sitewhere-microservices" aria-hidden="true" class="header-anchor">#</a> Start SiteWhere Microservices</h3> <p>In a separate terminal, navigate to the <strong>sitewhere-recipes/docker-compose/default</strong>
subdirectory. This recipe contains all of the SiteWhere microservices and expects
other infrastructure services to already be running. As with the infrastructure recipe,
run the following command to start SiteWhere:</p> <div class="language-sh extra-class"><pre class="language-text"><code>docker-compose up
</code></pre></div><p>Docker compose will begin launching the SiteWhere microservices. The log output is a
combination of the output for all of the individual microservices and supporting technologies.</p> <h3 id="system-log-output"><a href="#system-log-output" aria-hidden="true" class="header-anchor">#</a> System Log Output</h3> <p>The log output for SiteWhere 2.x is significantly different than 1.x due to the
distributed nature of the system and the fact that every microservice runs in a
separate Java process. The microservices can start in any order and use Apache ZooKeeper
as a central point for coordination. In many cases, there are dependencies between
microservices such as the need for bootstrapping system data or providing access to
parts of the data model. Log messages such as <strong>Waiting for tenant management API to become available</strong>
are common during the bootstrapping process. For more detailed information about the
system startup process, see the <a href="/docs/2.1.1/guide/">startup and bootstrap</a> document.</p></div> <div class="page-edit"><div class="edit-link"><a href="https://github.com/sitewhere/sitewhere-documentation/edit/master/docs/deployment/docker.md" target="_blank" rel="noopener noreferrer">Edit this page on GitHub</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">Last Updated: </span> <span class="time">10/18/2018, 2:46:55 PM</span></div></div> <!----> </div> <!----></div></div>
    <script src="/docs/2.1.1/assets/js/app.5ea96ced.js" defer></script><script src="/docs/2.1.1/assets/js/7.af7f9977.js" defer></script>
  </body>
</html>
