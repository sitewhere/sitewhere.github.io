(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{286:function(e,t,s){"use strict";s.r(t);var r=s(1),n=Object(r.a)({},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"content"},[e._m(0),e._v(" "),s("Seo"),e._v(" "),s("p",[e._v("This guide covers the SiteWhere 2.1 deployment process which has changed\nsignificantly from the one used for SiteWhere 1.x. While previous versions\nof SiteWhere were deployed as a single server node, the SiteWhere 2.1\narchitecture is based on many microservices which are deployed into a\n"),s("a",{attrs:{href:"https://https://kubernetes.io",target:"_blank",rel:"noopener noreferrer"}},[e._v("Kubernetes"),s("OutboundLink")],1),e._v(" infrastructure.")]),e._v(" "),s("InlineImage",{attrs:{src:"/images/deployment/deployment.png",caption:"SiteWhere Deployment Diagram"}}),e._v(" "),e._m(1),e._v(" "),s("p",[e._v("Because SiteWhere 2.1 uses a microservices architecture, the number of\nprocesses running concurrently has increased, which in turn requires\nmore memory and processing power. The minimum hardware specifications\nfor a single node Kubernetes cluster running a SiteWhere instance is:")]),e._v(" "),e._m(2),e._v(" "),s("p",[e._v("In most real-world deployment scenarios, a multi-node Kubernetes cluster\nwill be used so that the system can be made highly available. In cases\nwhere microservices are distributed across multiple k8s nodes,\nthe per-node requirements can be adjusted based on the number of\nmicroservices per node (generally 500MB of memory per microservice).")]),e._v(" "),e._m(3),e._v(" "),s("p",[e._v("SiteWhere 2.1 uses Kubernetes as a production-grade container orchestration solution\nwhich may be installed both locally/on-premise and in all major cloud environments.\nKubernetes clusters are available as a service on\n"),s("a",{attrs:{href:"https://cloud.google.com/kubernetes-engine/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Google Cloud"),s("OutboundLink")],1),e._v(",\n"),s("a",{attrs:{href:"https://aws.amazon.com/eks/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Amazon AWS"),s("OutboundLink")],1),e._v(",\n"),s("a",{attrs:{href:"https://azure.microsoft.com/en-us/services/kubernetes-service/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Azure"),s("OutboundLink")],1),e._v(" and\nmost of the other cloud providers.")]),e._v(" "),e._m(4),e._v(" "),s("p",[e._v("A single-node Kubernetes cluster may be deployed for SiteWhere development\nand testing. Depending on the underlying operating system used, there are\na few options for running a local k8s instance.")]),e._v(" "),e._m(5),e._v(" "),s("p",[s("a",{attrs:{href:"https://www.docker.com/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Docker"),s("OutboundLink")],1),e._v(" provides the default container implementation\nused by most Kubernetes providers. The Docker ecosystem has embraced Kubernetes\nand offers out-of-the-box support for running a single-node instance via\ntheir "),s("a",{attrs:{href:"https://docs.docker.com/v17.09/docker-for-windows/install/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Docker for Windows"),s("OutboundLink")],1),e._v("\nand "),s("a",{attrs:{href:"https://docs.docker.com/v17.09/docker-for-mac/install/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Docker for Mac"),s("OutboundLink")],1),e._v("\nofferings. After installing the core Docker components, Kubernetes support\nmay be enabled directly from within the Docker settings. For most users, this\nis the fastest path to getting a local Kubernetes environment running. For more\ndetails see "),s("a",{attrs:{href:"https://blog.docker.com/2018/07/kubernetes-is-now-available-in-docker-desktop-stable-channel/",target:"_blank",rel:"noopener noreferrer"}},[e._v("this blog"),s("OutboundLink")],1),e._v("\nfrom the Docker team.")]),e._v(" "),e._m(6),e._v(" "),s("p",[s("a",{attrs:{href:"https://github.com/kubernetes/minikube",target:"_blank",rel:"noopener noreferrer"}},[e._v("Minikube"),s("OutboundLink")],1),e._v(" is a tool that makes it easy\nto run a single-node Kubernetes cluster inside a virtual machine. Environments supported\ninclude "),s("a",{attrs:{href:"https://www.virtualbox.org/",target:"_blank",rel:"noopener noreferrer"}},[e._v("VirtualBox"),s("OutboundLink")],1),e._v(",\n"),s("a",{attrs:{href:"https://www.vmware.com/products/fusion.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("VMware Fusion"),s("OutboundLink")],1),e._v("\nand many others. For complete instructions on installing/deploying Minikube\nsee their "),s("a",{attrs:{href:"https://kubernetes.io/docs/setup/minikube/",target:"_blank",rel:"noopener noreferrer"}},[e._v("setup guide"),s("OutboundLink")],1),e._v(".")]),e._v(" "),s("p",[e._v("If a Kubernetes cluster is installed on bare metal or on virtual machines, it’s missing an external\nload balancer. It’s a cloud network load balancer that comes with platforms such as Azure or GCM,\nthat provides an externally-accessible IP address that sends traffic to the correct port on your cluster nodes.\n"),s("a",{attrs:{href:"https://metallb.universe.tf/",target:"_blank",rel:"noopener noreferrer"}},[e._v("MetalLB"),s("OutboundLink")],1),e._v(" is a load balancer designed to run on and to work with Kubernetes\nand it will allow you to use the type LoadBalancer when you declare a service.")]),e._v(" "),e._m(7),e._v(" "),e._m(8),s("p",[e._v("This manifest creates a bunch of resources. Most of them are related to access control, so that MetalLB can\nread and write the Kubernetes objects it needs to do its job.")]),e._v(" "),e._m(9),e._v(" "),e._m(10),s("p",[e._v("similar output should appear:")]),e._v(" "),e._m(11),s("p",[e._v("For complete instructions on installing MetalLB see their "),s("a",{attrs:{href:"https://metallb.universe.tf/installation/",target:"_blank",rel:"noopener noreferrer"}},[e._v("MetalLB installation"),s("OutboundLink")],1),e._v(".")]),e._v(" "),e._m(12),e._v(" "),e._m(13),e._v(" "),e._m(14),s("p",[e._v("Result example:")]),e._v(" "),e._m(15),s("p",[e._v("Apply this configuration:")]),e._v(" "),e._m(16),s("p",[e._v("For complete instructions on configuration MetalLB see their "),s("a",{attrs:{href:"https://metallb.universe.tf/configuration/",target:"_blank",rel:"noopener noreferrer"}},[e._v("MetalLB configuration"),s("OutboundLink")],1),e._v(".")]),e._v(" "),e._m(17),e._v(" "),s("p",[e._v("For a complete list of other options for deploying Kubernetes, see the\n"),s("a",{attrs:{href:"https://kubernetes.io/docs/setup/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Kubernetes Setup Guide"),s("OutboundLink")],1),e._v(".")]),e._v(" "),e._m(18),e._v(" "),s("p",[e._v("Steps  requiered to install locally generated images when minikube is used:")]),e._v(" "),e._m(19),e._m(20),e._v(" "),s("p",[e._v("The preferred method of deploying a SiteWhere 2.1 instance to a running Kubernetes\nCluster is by using "),s("a",{attrs:{href:"https://helm.sh/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Helm"),s("OutboundLink")],1),e._v(", which supports a streamlined,\nconfigurable deployment process. SiteWhere provides Helm\n"),s("a",{attrs:{href:"https://github.com/sitewhere/sitewhere-k8s/tree/master/charts",target:"_blank",rel:"noopener noreferrer"}},[e._v("charts"),s("OutboundLink")],1),e._v(" which\ncan be used to bootstrap the system in various configurations depending\non the profiles and other configuration options selected.")]),e._v(" "),s("p",[e._v("In order to deploy SiteWhere, Helm needs to be installed. Follow\n"),s("a",{attrs:{href:"https://docs.helm.sh/using_helm/#installing-helm",target:"_blank",rel:"noopener noreferrer"}},[e._v("these"),s("OutboundLink")],1),e._v(" instructions to install\nHelm in your environment.")]),e._v(" "),e._m(21),e._v(" "),e._m(22),e._v(" "),s("p",[e._v("SiteWhere 2.1 requeries "),s("a",{attrs:{href:"https://istio.io/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Istio"),s("OutboundLink")],1),e._v(", with\n"),s("a",{attrs:{href:"https://istio.io/docs/setup/kubernetes/additional-setup/sidecar-injection/#automatic-sidecar-injection",target:"_blank",rel:"noopener noreferrer"}},[e._v("Automatic sidecar injection"),s("OutboundLink")],1),e._v(",\ninstalled on a Kubernetes cluster before you deploy an instance of SiteWhere. You can install Istio\n"),s("a",{attrs:{href:"https://istio.io/docs/setup/kubernetes/install/helm/",target:"_blank",rel:"noopener noreferrer"}},[e._v("with"),s("OutboundLink")],1),e._v(" or "),s("a",{attrs:{href:"https://istio.io/docs/setup/kubernetes/install/kubernetes/",target:"_blank",rel:"noopener noreferrer"}},[e._v("without"),s("OutboundLink")],1),e._v(" Helm.")]),e._v(" "),e._m(23),e._v(" "),e._m(24),e._m(25),s("p",[e._v("If not, add the label to the namespace:")]),e._v(" "),e._m(26),e._m(27),e._v(" "),s("p",[e._v("To intall SiteWhere using Helm, you need to add the "),s("a",{attrs:{href:"https://sitewhere.io/helm-charts",target:"_blank",rel:"noopener noreferrer"}},[e._v("SiteWhere Helm Repository"),s("OutboundLink")],1),e._v("\nto your helm client.")]),e._v(" "),e._m(28),s("p",[e._v("Then you need to update your local helm repository")]),e._v(" "),e._m(29),e._m(30),e._v(" "),e._m(31),e._m(32),e._v(" "),s("p",[e._v("In order to make the process of installing the various SiteWhere infrastructure\ncomponents easier, a separate "),s("a",{attrs:{href:"https://github.com/sitewhere/sitewhere-k8s",target:"_blank",rel:"noopener noreferrer"}},[e._v("repository"),s("OutboundLink")],1),e._v("\nis made available for the various k8s artifacts.")]),e._v(" "),e._m(33),e._v(" "),s("p",[e._v("Using a "),s("a",{attrs:{href:"https://git-scm.com/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Git"),s("OutboundLink")],1),e._v(" client, clone the repository to the machine\nwhere you have the Kubernetes environment configured. The repository can be cloned\nwith the following command:")]),e._v(" "),e._m(34),e._m(35),e._v(" "),e._m(36),e._v(" "),s("p",[e._v("To install SiteWhere with the default configuration (including all microservices and\nthe default infrastructure components) run:")]),e._v(" "),e._m(37),e._m(38),e._v(" "),e._m(39),e._v(" "),e._m(40),s("p",[e._v("In this configuration, some services will not be available and the corresponding\nAPIs will return error codes indicating that requests for the service can not\nbe satisfied.")]),e._v(" "),e._m(41),e._v(" "),e._m(42),e._v(" "),e._m(43),e._m(44),e._v(" "),e._m(45),e._v(" "),s("p",[e._v("In order to support multi-node persistent storage for SiteWhere infrastucture components\nsuch as Kafka, Zookeeper, and the various database technologies, a distributed\nstorage system such as "),s("a",{attrs:{href:"https://ceph.com/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Ceph"),s("OutboundLink")],1),e._v(" should be used. The\n"),s("a",{attrs:{href:"https://rook.io",target:"_blank",rel:"noopener noreferrer"}},[e._v("Rook"),s("OutboundLink")],1),e._v(" project supports a streamlined process for deploying\nCeph in a Kubernetes environment, allowing for scalable, reliable persistent\nstorage that may be used directly from standard k8s storage APIs.")]),e._v(" "),s("p",[e._v("By executing the following list of commands, a Rook cluster will be bootstrapped\nand made available for use by SiteWhere.")]),e._v(" "),e._m(46),s("p",[e._v("Note that the Rook components allow persistent information such as databases\nor other system state to be kept outside of the SiteWhere instance. SiteWhere\nuses k8s "),s("a",{attrs:{href:"https://kubernetes.io/docs/concepts/storage/persistent-volumes/",target:"_blank",rel:"noopener noreferrer"}},[e._v("persistent volumes"),s("OutboundLink")],1),e._v("\nto create references to the persistent data which is made available across the k8s\ncluster in a replicated, highly-available fashion and lives beyond system restarts.\nThe underlying data is only deleted if the PVCs/PVs are manually deleted.")]),e._v(" "),e._m(47),e._v(" "),s("p",[e._v("Once SiteWhere has been installed, there are many ways of interacting with the system\nto verify that the microservices have started successfully. Any of the standard\nKubernetes tooling may be used to introspect the SiteWhere pods.")]),e._v(" "),e._m(48),e._v(" "),s("p",[s("a",{attrs:{href:"https://code.visualstudio.com/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Visual Studio Code"),s("OutboundLink")],1),e._v(" offers an optional Kubernetes\nplugin which supports management of many aspects of a running cluster. The extension\nis published as an "),s("a",{attrs:{href:"https://github.com/Azure/vscode-kubernetes-tools",target:"_blank",rel:"noopener noreferrer"}},[e._v("open source"),s("OutboundLink")],1),e._v("\nrepository and may be installed via the VS Code extension manager.")]),e._v(" "),s("InlineImage",{attrs:{src:"/images/deployment/vs-code-kubernetes-plugin.png",caption:"Kubernetes Plugin"}}),e._v(" "),e._m(49),e._v(" "),s("InlineImage",{attrs:{src:"/images/deployment/vs-code-sitewhere-services.png",caption:"SiteWhere Services"}}),e._v(" "),e._m(50),e._v(" "),s("p",[e._v("The Kubernetes project includes a dashboard user interface that may be used to view the\ncluster components for tasks such as monitoring component status and viewing logs. For complete\ninstructions on installing the Kubernetes Dashboard UI, refer to the dashboard deployment\n"),s("a",{attrs:{href:"https://kubernetes.io/docs/tasks/access-application-cluster/web-ui-dashboard/#deploying-the-dashboard-ui",target:"_blank",rel:"noopener noreferrer"}},[e._v("documentation"),s("OutboundLink")],1),e._v(".")]),e._v(" "),e._m(51),e._v(" "),s("p",[e._v("Once a SiteWhere instance has been deployed, the SiteWhere administrative application may be\nused to connect to the instance and configure it. The administrative application is based on\n"),s("a",{attrs:{href:"https://electronjs.org/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Electron"),s("OutboundLink")],1),e._v(" and may be downloaded from directly from the project\n"),s("a",{attrs:{href:"https://github.com/sitewhere/sitewhere-admin-ui/releases",target:"_blank",rel:"noopener noreferrer"}},[e._v("releases"),s("OutboundLink")],1),e._v(" page. After installing\nthe application, open it and log in using the default administrative credentials:")]),e._v(" "),e._m(52),e._v(" "),e._m(53),e._v(" "),s("InlineImage",{attrs:{src:"/images/platform/login.png",caption:"Administrative Application"}}),e._v(" "),s("p",[e._v("See the user guide for more information about using the administrative application.")]),e._v(" "),e._m(54),e._v(" "),s("p",[e._v("To remove SiteWhere, execute the following command")]),e._v(" "),e._m(55),e._m(56),e._v(" "),s("p",[e._v("In order to remove all SiteWhere data and start with a clean system, you need remove the\n"),s("a",{attrs:{href:"https://kubernetes.io/docs/concepts/storage/persistent-volumes/",target:"_blank",rel:"noopener noreferrer"}},[e._v("persistent volume claims"),s("OutboundLink")],1),e._v("\nthat the SiteWhere infrastructure components create. The following commands may be\nused to delete data added by the default SiteWhere configuration:")]),e._v(" "),e._m(57),e._m(58),e._v(" "),s("p",[e._v("To uninstall Rook and the Ceph components it wraps, refer to this\n"),s("a",{attrs:{href:"https://rook.io/docs/rook/v0.8/ceph-teardown.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("document"),s("OutboundLink")],1),e._v(", and\nfollow the instructions to remove the components and related data.")]),e._v(" "),e._m(59)],1)},[function(){var e=this.$createElement,t=this._self._c||e;return t("h1",{attrs:{id:"installing-a-sitewhere-instance"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#installing-a-sitewhere-instance","aria-hidden":"true"}},[this._v("#")]),this._v(" Installing a SiteWhere Instance")])},function(){var e=this.$createElement,t=this._self._c||e;return t("h2",{attrs:{id:"system-requirements"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#system-requirements","aria-hidden":"true"}},[this._v("#")]),this._v(" System Requirements")])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("table",[s("thead",[s("tr",[s("th",[e._v("Resource")]),e._v(" "),s("th",[e._v("Min Value")])])]),e._v(" "),s("tbody",[s("tr",[s("td",[e._v("Memory")]),e._v(" "),s("td",[e._v("16GB RAM")])]),e._v(" "),s("tr",[s("td",[e._v("CPU")]),e._v(" "),s("td",[e._v("4 CPUs")])]),e._v(" "),s("tr",[s("td",[e._v("Hard Disk/SSD")]),e._v(" "),s("td",[e._v("100GB")])])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("h2",{attrs:{id:"install-kubernetes"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#install-kubernetes","aria-hidden":"true"}},[this._v("#")]),this._v(" Install Kubernetes")])},function(){var e=this.$createElement,t=this._self._c||e;return t("h3",{attrs:{id:"installing-a-single-node-development-environment"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#installing-a-single-node-development-environment","aria-hidden":"true"}},[this._v("#")]),this._v(" Installing a Single-Node Development Environment")])},function(){var e=this.$createElement,t=this._self._c||e;return t("h4",{attrs:{id:"using-docker-kubernetes-integration"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#using-docker-kubernetes-integration","aria-hidden":"true"}},[this._v("#")]),this._v(" Using Docker/Kubernetes Integration")])},function(){var e=this.$createElement,t=this._self._c||e;return t("h4",{attrs:{id:"using-minikube"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#using-minikube","aria-hidden":"true"}},[this._v("#")]),this._v(" Using Minikube")])},function(){var e=this.$createElement,t=this._self._c||e;return t("p",[t("strong",[this._v("Install MetalLB on Minikube")]),t("br"),this._v("\nMetalLB runs in two parts: a cluster-wide controller, and a per-machine protocol speaker. Install MetalLB by\napplying the manifest:")])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[this._v("$ kubectl apply -f https://raw.githubusercontent.com/google/metallb/v0.7.3/manifests/metallb.yaml\n")])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("p",[this._v("The two pieces of interest are the "),t("strong",[this._v("“controller”")]),this._v(" deployment, and the "),t("strong",[this._v("“speaker”")]),this._v(" DaemonSet. By monitoring:")])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[this._v("$ kubectl get pods -n metallb-system\n")])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[this._v("NAME                          READY     STATUS    RESTARTS   AGE\ncontroller-7fbd769fcc-58fm8   1/1       Running   0          50m\nspeaker-rctgd                 1/1       Running   0          50m\n")])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("p",[t("strong",[this._v("Apply ConfigMap")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("p",[this._v("MetalLB’s configuration is a standard Kubernetes ConfigMap, config under the metallb-system namespace. It contains two pieces\nof information: what IP addresses it’s allowed to hand out and which protocol to use for such task.\nIn this configuration MetalLB is instructed to hand out address from the 192.168.99.100/28 range, using layer 2 mode (protocol: layer2)."),t("br"),this._v("\nIn local development, Minikube IP address is used as the start of the range.\nTo get Minikube IP address use:")])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[this._v("$ minikube ip\n")])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[this._v("192.168.99.100\n")])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[this._v("apiVersion: v1\nkind: ConfigMap\nmetadata:\n  namespace: metallb-system\n  name: config\ndata:\n  config: "),t("span",{attrs:{class:"token operator"}},[this._v("|")]),this._v("\n    address-pools:\n    - name: custom-ip-space\n      protocol: layer2\n      addresses:\n      - 192.168.99.100/28\n")])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("h4",{attrs:{id:"more-options"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#more-options","aria-hidden":"true"}},[this._v("#")]),this._v(" More Options")])},function(){var e=this.$createElement,t=this._self._c||e;return t("p",[t("strong",[this._v("Install local docker images in minikube")])])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{attrs:{class:"token comment"}},[e._v("# Start minikube")]),e._v("\nminikube start\n\n"),s("span",{attrs:{class:"token comment"}},[e._v("# Set docker env")]),e._v("\n"),s("span",{attrs:{class:"token function"}},[e._v("eval")]),e._v(" "),s("span",{attrs:{class:"token variable"}},[s("span",{attrs:{class:"token variable"}},[e._v("$(")]),e._v("minikube docker-env"),s("span",{attrs:{class:"token variable"}},[e._v(")")])]),e._v("\n\n"),s("span",{attrs:{class:"token comment"}},[e._v("# Create docker image.")]),e._v("\n./gradlew dockerImage\n\n"),s("span",{attrs:{class:"token comment"}},[e._v("# Install images with helm, where tag is de tag of the image.")]),e._v("\nhelm "),s("span",{attrs:{class:"token function"}},[e._v("install")]),e._v(" --name sitewhere --set services.image.tag"),s("span",{attrs:{class:"token operator"}},[e._v("=")]),e._v("2.1.0 sitewhere/sitewhere\n")])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("h2",{attrs:{id:"install-helm"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#install-helm","aria-hidden":"true"}},[this._v("#")]),this._v(" Install Helm")])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"warning custom-block"},[t("p",{staticClass:"custom-block-title"},[this._v("WARNING")]),this._v(" "),t("p",[this._v("SiteWhere does not currently support Helm 3 since it has not been officially released\nand there are significant changes to the architecture and CLI commands. All instructions\nrelated to Helm assume that a 2.x version is being used.")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("h2",{attrs:{id:"install-istio"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#install-istio","aria-hidden":"true"}},[this._v("#")]),this._v(" Install Istio")])},function(){var e=this.$createElement,t=this._self._c||e;return t("p",[this._v("Make sure that the namespace where you are deploying SiteWhere has the label "),t("code",[this._v("istio-injection=enabled")]),this._v(",\nfor example for the "),t("code",[this._v("default")]),this._v(" namespace use:")])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[this._v("kubectl get namespace -L istio-injection\n")])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[this._v("NAME           STATUS    AGE       ISTIO-INJECTION\ndefault        Active    1h        enabled\nistio-system   Active    1h\nkube-public    Active    1h\nkube-system    Active    1h\n")])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[this._v("kubectl label namespace default istio-injection"),t("span",{attrs:{class:"token operator"}},[this._v("=")]),this._v("enabled\n")])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("h2",{attrs:{id:"install-sitewhere-from-sitewhere-helm-repository"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#install-sitewhere-from-sitewhere-helm-repository","aria-hidden":"true"}},[this._v("#")]),this._v(" Install SiteWhere from SiteWhere Helm Repository")])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[this._v("helm repo add sitewhere https://sitewhere.io/helm-charts\n")])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[this._v("helm repo update\n")])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("p",[this._v("To install the chart with the release name "),t("code",[this._v("sitewhere")]),this._v(" execute:")])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[this._v("helm "),t("span",{attrs:{class:"token function"}},[this._v("install")]),this._v(" --name sitewhere sitewhere/sitewhere\n")])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("h2",{attrs:{id:"install-sitewhere-from-sitewhere-kubernetes-repository"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#install-sitewhere-from-sitewhere-kubernetes-repository","aria-hidden":"true"}},[this._v("#")]),this._v(" Install SiteWhere from SiteWhere Kubernetes Repository")])},function(){var e=this.$createElement,t=this._self._c||e;return t("h3",{attrs:{id:"clone-the-repository"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#clone-the-repository","aria-hidden":"true"}},[this._v("#")]),this._v(" Clone the Repository")])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{attrs:{class:"token function"}},[this._v("git")]),this._v(" clone https://github.com/sitewhere/sitewhere-k8s.git\n")])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("p",[this._v("Once the repository has been cloned, navigate into the "),t("strong",[this._v("sitewhere-k8s/charts")]),this._v("\nsubdirectory. This directory contains Helm Charts and Kubernetes resources for SiteWhere\ndeployment scenarios.")])},function(){var e=this.$createElement,t=this._self._c||e;return t("h3",{attrs:{id:"install-sitewhere"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#install-sitewhere","aria-hidden":"true"}},[this._v("#")]),this._v(" Install SiteWhere")])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[this._v("helm "),t("span",{attrs:{class:"token function"}},[this._v("install")]),this._v(" --name sitewhere ./sitewhere\n")])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("h3",{attrs:{id:"running-with-constrained-resources"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#running-with-constrained-resources","aria-hidden":"true"}},[this._v("#")]),this._v(" Running with Constrained Resources")])},function(){var e=this.$createElement,t=this._self._c||e;return t("p",[this._v("If you wish to run SiteWhere in a low resource cluster, use the "),t("em",[this._v("minimal")]),this._v(" profile\nwith the Helm Chart to only install the core microservices required to bootstrap\nthe system:")])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[this._v("helm "),t("span",{attrs:{class:"token function"}},[this._v("install")]),this._v(" --name sitewhere --set services.profile"),t("span",{attrs:{class:"token operator"}},[this._v("=")]),this._v("minimal ./sitewhere\n")])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("h3",{attrs:{id:"running-with-host-storage"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#running-with-host-storage","aria-hidden":"true"}},[this._v("#")]),this._v(" Running with Host Storage")])},function(){var e=this.$createElement,t=this._self._c||e;return t("p",[this._v("If you don't need Rook.io, you can skip the Rook.io install and install\nSiteWhere Helm Chart setting the "),t("code",[this._v("persistence.storageClass")]),this._v(" property to\nother than "),t("code",[this._v("rook-ceph-block")]),this._v(", for example to use "),t("code",[this._v("hostpath")]),this._v(" Persistence\nStorage Class, use the following command:")])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[this._v("helm "),t("span",{attrs:{class:"token function"}},[this._v("install")]),this._v(" --name sitewhere --set persistence.storageClass"),t("span",{attrs:{class:"token operator"}},[this._v("=")]),this._v("hostpath ./sitewhere\n")])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("h2",{attrs:{id:"install-rook"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#install-rook","aria-hidden":"true"}},[this._v("#")]),this._v(" Install Rook")])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"tip custom-block"},[t("p",{staticClass:"custom-block-title"},[this._v("TIP")]),this._v(" "),t("p",[this._v("This step is optional, but it is recommended for production grade installations.")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[this._v("kubectl create -f rook/common.yaml\nkubectl create -f rook/operator.yaml\nkubectl create -f rook/cluster.yaml\nkubectl create -f rook/storageclass.yaml\n")])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("h2",{attrs:{id:"monitor-sitewhere-services"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#monitor-sitewhere-services","aria-hidden":"true"}},[this._v("#")]),this._v(" Monitor SiteWhere Services")])},function(){var e=this.$createElement,t=this._self._c||e;return t("h3",{attrs:{id:"using-visual-studio-code-kubernetes-support"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#using-visual-studio-code-kubernetes-support","aria-hidden":"true"}},[this._v("#")]),this._v(" Using Visual Studio Code Kubernetes Support")])},function(){var e=this.$createElement,t=this._self._c||e;return t("p",[this._v("After installing the plugin, browse into the Kubernetes nodes to see the running services.\nOnce all of the infrastructure services have started, the SiteWhere services will start.\nTo browse the logs for the individual services, right-click on a pod in the tree and choose\n"),t("code",[this._v("Follow Logs")]),this._v(" to attach to the logs for that microservice in a terminal. Multiple terminals\nmay be opened concurrently to track logs for multiple services.")])},function(){var e=this.$createElement,t=this._self._c||e;return t("h3",{attrs:{id:"using-kubernetes-dashboard-ui"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#using-kubernetes-dashboard-ui","aria-hidden":"true"}},[this._v("#")]),this._v(" Using Kubernetes Dashboard UI")])},function(){var e=this.$createElement,t=this._self._c||e;return t("h2",{attrs:{id:"run-the-administrative-application"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#run-the-administrative-application","aria-hidden":"true"}},[this._v("#")]),this._v(" Run the Administrative Application")])},function(){var e=this.$createElement,t=this._self._c||e;return t("p",[t("strong",[this._v("username")]),this._v(": "),t("code",[this._v("admin")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("p",[t("strong",[this._v("password")]),this._v(": "),t("code",[this._v("password")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("h2",{attrs:{id:"remove-sitewhere"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#remove-sitewhere","aria-hidden":"true"}},[this._v("#")]),this._v(" Remove SiteWhere")])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[this._v("helm del --purge sitewhere\n")])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("h3",{attrs:{id:"remove-sitewhere-persistent-data"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#remove-sitewhere-persistent-data","aria-hidden":"true"}},[this._v("#")]),this._v(" Remove SiteWhere Persistent Data")])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[this._v("kubectl delete pvc -l release"),t("span",{attrs:{class:"token operator"}},[this._v("=")]),this._v("sitewhere\n")])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("h2",{attrs:{id:"uninstall-rook"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#uninstall-rook","aria-hidden":"true"}},[this._v("#")]),this._v(" Uninstall Rook")])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"tip custom-block"},[t("p",{staticClass:"custom-block-title"},[this._v("TIP")]),this._v(" "),t("p",[this._v("To delete the persistent data associated with SiteWhere, it is not necessary\nto uninstall Rook. As detailed above, the k8s persistence claims may be\ndeleted to remove existing data and start with a clean system.")])])}],!1,null,null,null);n.options.__file="README.md";t.default=n.exports}}]);